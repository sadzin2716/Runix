-- 1. Biblioteca MaterialLua 
local Material = loadstring(game:HttpGet("https://raw.githubusercontent.com/Kinlei/MaterialLua/master/Module.lua"))()

-- 2. ServiÃ§os e variÃ¡veis
local Players, RunService, LocalPlayer = game:GetService("Players"), game:GetService("RunService"), game:GetService("Players").LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local camera = workspace.CurrentCamera
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local config = { espEnabled = true, enemyColor = Color3.fromRGB(255,0,0), teamColor = Color3.fromRGB(0,255,0) }
local hitboxConfig = { enabled = false, size = Vector3.new(7,7,7), normalSize = Vector3.new(2,2,1) }

-- ConfiguraÃ§Ã£o do Auto Farm COM COORDENADAS PRÃ‰-DEFINIDAS
local autoFarmConfig = {
    enabled = false,
    autoShoot = false,
    wallbang = false,
    shootDelay = 0.05,
    teleportToPad = false,
    padPosition = CFrame.new(31.6, -114.5, 57.9) -- Coordenadas do pad salvas!
}

-- 3. FunÃ§Ãµes ESP / Hitbox
local function updateAll()
    for _, pl in pairs(Players:GetPlayers()) do
        if pl ~= LocalPlayer and pl.Character then
            local hl = pl.Character:FindFirstChild("ESP_Highlight")
            if hl then
                local col = (pl.Team == LocalPlayer.Team) and config.teamColor or config.enemyColor
                hl.FillColor, hl.OutlineColor, hl.Enabled = col, col, config.espEnabled
            end
            local hrp = pl.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                if hitboxConfig.enabled and pl.Team ~= LocalPlayer.Team then
                    hrp.Size, hrp.Transparency, hrp.Material = hitboxConfig.size, 0.6, Enum.Material.ForceField
                else
                    hrp.Size, hrp.Transparency, hrp.Material = hitboxConfig.normalSize, 1, Enum.Material.Plastic
                end
                hrp.CanCollide = false
            end
        end
    end
end

local function tryCreateESP(pl, char)
    if char:FindFirstChild("ESP_Highlight") then return end
    local hl = Instance.new("Highlight", char)
    hl.Name, hl.FillTransparency, hl.OutlineTransparency = "ESP_Highlight", 0.5, 0
    hl.FillColor = (pl.Team == LocalPlayer.Team) and config.teamColor or config.enemyColor
    hl.OutlineColor = hl.FillColor
    hl.Enabled = config.espEnabled
end

local function applyToPlayer(pl)
    if pl == LocalPlayer then return end
    pl.CharacterAdded:Connect(function(char)
        repeat task.wait() until char:FindFirstChild("HumanoidRootPart")
        tryCreateESP(pl, char)
        updateAll()
    end)
    if pl.Character then
        tryCreateESP(pl, pl.Character)
        updateAll()
    end
end
for _, pl in pairs(Players:GetPlayers()) do applyToPlayer(pl) end
Players.PlayerAdded:Connect(applyToPlayer)
task.spawn(function() while true do if hitboxConfig.enabled then updateAll() end RunService.Heartbeat:Wait() end end)

-- 4. Aimbot com FOV e Lerp
local aiming = false
local aimbotFOV = 100

local function isAlive(plr)
    return plr.Character and plr.Character:FindFirstChild("Head") and plr.Character:FindFirstChild("Humanoid") and plr.Character.Humanoid.Health > 0
end

local function getClosestTarget()
    local closest, shortestDist = nil, math.huge
    local mousePos = Vector2.new(Mouse.X, Mouse.Y)
    for _, pl in pairs(Players:GetPlayers()) do
        if pl ~= LocalPlayer and isAlive(pl) then
            local headPos, onScreen = camera:WorldToViewportPoint(pl.Character.Head.Position)
            if onScreen then
                local screenPos = Vector2.new(headPos.X, headPos.Y)
                local dist = (mousePos - screenPos).Magnitude
                if dist < shortestDist and dist <= aimbotFOV then
                    shortestDist = dist
                    closest = pl
                end
            end
        end
    end
    return closest
end

local Drawing = Drawing
local fovCircle = Drawing.new("Circle")
fovCircle.Visible = false
fovCircle.Radius = aimbotFOV
fovCircle.Thickness = 2
fovCircle.Transparency = 0.5
fovCircle.Color = Color3.fromRGB(255, 255, 0)
fovCircle.Filled = false

RunService.RenderStepped:Connect(function()
    fovCircle.Position = Vector2.new(Mouse.X, Mouse.Y + 36)
    fovCircle.Radius = aimbotFOV
    fovCircle.Visible = aiming
end)

RunService.RenderStepped:Connect(function()
    if aiming then
        local target = getClosestTarget()
        if target and target.Character and target.Character:FindFirstChild("Head") then
            local cam = workspace.CurrentCamera
            local headPos = target.Character.Head.Position
            local camPos = cam.CFrame.Position
            local desiredCFrame = CFrame.new(camPos, headPos)
            cam.CFrame = cam.CFrame:Lerp(desiredCFrame, 0.15)
        end
    end
end)

-- 5. SISTEMA DE AUTO FARM CORRIGIDO

local function saveCurrentPosition()
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then 
        return false 
    end
    
    autoFarmConfig.padPosition = LocalPlayer.Character.HumanoidRootPart.CFrame
    local pos = autoFarmConfig.padPosition.Position
    print(string.format("[Auto Farm] âœ… PosiÃ§Ã£o salva: X: %.1f, Y: %.1f, Z: %.1f", pos.X, pos.Y, pos.Z))
    return true
end

local function teleportToPad()
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then 
        return false
    end
    
    if not autoFarmConfig.padPosition then
        print("[Auto Farm] âŒ ERRO: Nenhuma posiÃ§Ã£o configurada!")
        return false
    end
    
    -- Teleporta para a posiÃ§Ã£o salva
    LocalPlayer.Character.HumanoidRootPart.CFrame = autoFarmConfig.padPosition
    wait(0.3)
    return true
end

local function getEnemyPlayer()
    for _, pl in pairs(Players:GetPlayers()) do
        if pl ~= LocalPlayer and pl.Team ~= LocalPlayer.Team and isAlive(pl) then
            return pl
        end
    end
    return nil
end

-- Sistema de Wallbang CORRIGIDO - sÃ³ afeta partes especÃ­ficas
local wallsDisabled = {}
local function enableWallbang(target)
    if not autoFarmConfig.wallbang or not target or not target.Character then return end
    
    local myPos = LocalPlayer.Character.HumanoidRootPart.Position
    local targetPos = target.Character.HumanoidRootPart.Position
    
    -- SÃ³ desabilita partes entre vocÃª e o alvo
    local ray = Ray.new(myPos, (targetPos - myPos).Unit * (targetPos - myPos).Magnitude)
    local hits = workspace:GetPartsInRegion3(Region3.new(myPos, targetPos):ExpandToGrid(4))
    
    for _, part in pairs(hits) do
        if part:IsA("BasePart") and 
           not part:IsDescendantOf(LocalPlayer.Character) and 
           not part:IsDescendantOf(target.Character) and
           part.CanCollide then
            
            wallsDisabled[part] = true
            part.CanCollide = false
        end
    end
end

local function restoreWalls()
    for part, _ in pairs(wallsDisabled) do
        if part and part.Parent then
            part.CanCollide = true
        end
    end
    wallsDisabled = {}
end

-- FunÃ§Ã£o de atirar CORRIGIDA - tiro contÃ­nuo
local shooting = false
local function shootAtTarget(target)
    if not target or not target.Character or shooting then return end
    
    local head = target.Character:FindFirstChild("Head")
    if not head then return end
    
    shooting = true
    
    -- Ativa wallbang se necessÃ¡rio
    if autoFarmConfig.wallbang then
        enableWallbang(target)
    end
    
    -- Mira na cabeÃ§a do inimigo
    local cam = workspace.CurrentCamera
    cam.CFrame = CFrame.new(cam.CFrame.Position, head.Position)
    
    -- Simula segurar o botÃ£o do mouse (tiro contÃ­nuo)
    mouse1press()
    
    shooting = false
end

local function stopShooting()
    mouse1release()
    if autoFarmConfig.wallbang then
        restoreWalls()
    end
end

-- Loop principal do Auto Farm CORRIGIDO
local farmRunning = false
local currentTarget = nil

task.spawn(function()
    while true do
        wait(0.05)
        
        if autoFarmConfig.enabled and not farmRunning then
            farmRunning = true
            
            task.spawn(function()
                while autoFarmConfig.enabled do
                    -- Teleporta para o pad
                    if autoFarmConfig.teleportToPad and autoFarmConfig.padPosition then
                        local myChar = LocalPlayer.Character
                        if myChar and myChar:FindFirstChild("HumanoidRootPart") then
                            local myPos = myChar.HumanoidRootPart.Position
                            local padPos = autoFarmConfig.padPosition.Position
                            local distance = (myPos - padPos).Magnitude
                            
                            -- SÃ³ teleporta se estiver longe do pad
                            if distance > 10 then
                                teleportToPad()
                                wait(1)
                            end
                        end
                    end
                    
                    -- Sistema de Auto Shoot CONTÃNUO
                    if autoFarmConfig.autoShoot then
                        local enemy = getEnemyPlayer()
                        
                        if enemy and isAlive(enemy) then
                            currentTarget = enemy
                            shootAtTarget(enemy)
                        else
                            -- Solta o gatilho se nÃ£o hÃ¡ inimigo
                            if currentTarget then
                                stopShooting()
                                currentTarget = nil
                            end
                        end
                    else
                        stopShooting()
                        currentTarget = nil
                    end
                    
                    wait(0.01) -- Loop bem rÃ¡pido para tiro contÃ­nuo
                end
                
                -- Limpa tudo ao desativar
                stopShooting()
                currentTarget = nil
                farmRunning = false
            end)
        end
        
        if not autoFarmConfig.enabled then
            stopShooting()
            farmRunning = false
        end
    end
end)

-- 6. GUI com MaterialLua
local themes = { "Dark", "Light", "Aqua", "Jester" }
local UI, PlayerTab, FarmTab

local function buildUI(theme)
    if UI then UI:Destroy() end
    UI = Material.Load({ Title="Runix Hub | MVSD", Style=1, SizeX=400, SizeY=450, Theme=theme or "Dark" })
    
    -- Aba Player
    PlayerTab = UI.New({ Title="Player" })
    PlayerTab.Toggle({ Text="Ativar ESP", Callback=function(s) config.espEnabled = s updateAll() end, Enabled=config.espEnabled })
    PlayerTab.Toggle({ Text="Hitbox Expandida (inimigos)", Callback=function(s) hitboxConfig.enabled = s updateAll() end, Enabled=hitboxConfig.enabled })
    PlayerTab.Toggle({ Text="Aimbot", Callback=function(s) aiming = s end, Enabled=aiming })

    PlayerTab.Slider({ Text="Tamanho Hitbox", Min=2, Max=15, Def=hitboxConfig.size.X,
        Callback=function(v) hitboxConfig.size = Vector3.new(v,v,v) updateAll() end })

    PlayerTab.Slider({ Text="Campo de VisÃ£o Aimbot", Min=20, Max=300, Def=aimbotFOV,
        Callback=function(v) aimbotFOV = v end })

    PlayerTab.Dropdown({
        Text="Tema da UI",
        Options=themes,
        Callback=function(sel)
            buildUI(sel)
        end
    })
    
    -- Aba Auto Farm
    FarmTab = UI.New({ Title="Auto Farm" })
    
    FarmTab.Button({
        Text="ğŸš€ Testar Teleporte para Pad",
        Callback=function()
            if teleportToPad() then
                print("[Auto Farm] âœ… Teleportado com sucesso!")
            else
                print("[Auto Farm] âŒ Erro ao teleportar!")
            end
        end
    })
    
    FarmTab.Button({
        Text="ğŸ“ Atualizar PosiÃ§Ã£o (onde estou agora)",
        Callback=function()
            if saveCurrentPosition() then
                print("[Auto Farm] âœ… Nova posiÃ§Ã£o salva!")
            else
                print("[Auto Farm] âŒ Erro ao salvar!")
            end
        end
    })
    
    FarmTab.Toggle({ 
        Text="ğŸ”¥ ATIVAR AUTO FARM", 
        Callback=function(s) 
            autoFarmConfig.enabled = s 
            if s then
                print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
                print("    ğŸ”¥ AUTO FARM ATIVADO!")
                print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
                print("ğŸ“ PosiÃ§Ã£o: X: 31.6, Y: -114.5, Z: 57.9")
                print("ğŸ¯ O bot vai comeÃ§ar a farmar agora!")
                print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
            else
                print("[Auto Farm] âŒ Auto Farm DESATIVADO!")
                stopShooting()
            end
        end, 
        Enabled=autoFarmConfig.enabled 
    })
    
    FarmTab.Toggle({ 
        Text="ğŸ“ Auto Teleport para Pad", 
        Callback=function(s) 
            autoFarmConfig.teleportToPad = s 
            if s then
                print("[Auto Farm] âœ… Auto Teleport ATIVADO!")
            end
        end, 
        Enabled=autoFarmConfig.teleportToPad 
    })
    
    FarmTab.Toggle({ 
        Text="ğŸ¯ Auto Shoot (Atirar Automaticamente)", 
        Callback=function(s) 
            autoFarmConfig.autoShoot = s 
            if s then
                print("[Auto Farm] âœ… Auto Shoot ATIVADO - Tiro contÃ­nuo!")
            else
                stopShooting()
            end
        end, 
        Enabled=autoFarmConfig.autoShoot 
    })
    
    FarmTab.Toggle({ 
        Text="ğŸ§± Wallbang (Atirar AtravÃ©s de Paredes)", 
        Callback=function(s) 
            autoFarmConfig.wallbang = s 
            if s then
                print("[Auto Farm] âœ… Wallbang ATIVADO - SÃ³ afeta obstÃ¡culos!")
            else
                restoreWalls()
            end
        end, 
        Enabled=autoFarmConfig.wallbang 
    })

    UI.Init()
end

buildUI("Dark")

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("    ğŸ® RUNIX HUB - MVSD AUTO FARM v2")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("âœ… Script carregado com sucesso!")
print("ğŸ“ Coordenadas prÃ©-configuradas:")
print("   X: 31.6, Y: -114.5, Z: 57.9")
print("")
print("ğŸ”§ CORREÃ‡Ã•ES APLICADAS:")
print("âœ… Wallbang corrigido - nÃ£o afeta o chÃ£o")
print("âœ… Auto Shoot contÃ­nuo - sem delay")
print("")
print("ğŸš€ INÃCIO RÃPIDO:")
print("1ï¸âƒ£ VÃ¡ na aba 'Auto Farm'")
print("2ï¸âƒ£ Ative 'ğŸ”¥ ATIVAR AUTO FARM'")
print("3ï¸âƒ£ Ative 'Auto Teleport', 'Auto Shoot' e 'Wallbang'")
print("4ï¸âƒ£ Deixe o bot farmar sozinho!")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
